<!DOCTYPE html>
<html>
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

        <!-- Bootstrap CSS -->
        <link
            rel="stylesheet"
            href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
            integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z"
            crossorigin="anonymous"
        />

        <title>Hello, world!</title>
        <link rel="stylesheet" href="style.css" />
    </head>

    <link rel="stylesheet" href="style.css" />

    <body>
        <nav class="navbar navbar-expand-lg navbar-light nav-distance">
            <a class="navbar-brand" href="#">인공지능 레시피</a>
            <button
                class="navbar-toggler"
                type="button"
                data-toggle="collapse"
                data-target="#navbarNav"
                aria-controls="navbarNav"
                aria-expanded="false"
                aria-label="Toggle navigation"
            >
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item active">
                        <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Features</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Pricing</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true"
                            >Disabled</a
                        >
                    </li>
                </ul>
            </div>
        </nav>
        <section class="section">
            <h1 class="title">인공지능 레시피 추천</h1>
            <h2 class="subtitle">재료에 맞는 레시피를 추천해드립니다.</h2>
        </section>

        
        <script
            class="jsbin"
            src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"
        ></script>
        <div class="container file-upload">
            <div class="image-upload-wrap">
                <input
                    class="file-upload-input"
                    type="file"
                    onchange="readURL(this);"
                    accept="image/*"
                />
                <div class="drag-text">
                    <img src="img/upload.svg" class="mt-3 pt-3 upload" />
                    <h3 class="mb-5 pb-5 pt-4 upload-text">
                        재료 사진을 올려놓거나 눌러서 업로드하세요!
                    </h3>
                </div>
            </div>
            <div class="file-upload-content">
                <img class="file-upload-image" id="mt-image" src="#" alt="your image" />
                <div id="loading" class="animated bounce">
                    <div class="spinner-border" role="status">
                        <span class="sr-only">Loading...</span>
                    </div>
                    <p class="text-center">재료를 분석중입니다.</p>
                </div>
                <p class="result-Message"></p>
                <div id="label-container"></div>
                <div class="image-title-wrap">
                    <button type="button" onclick="removeUpload()" class="remove-image">
                        Remove <span class="image-title">Uploaded Image</span>
                    </button>
                </div>
            </div>
        </div>
        <div id="webcam-container"></div>
        <div id="disqus_thread"></div>
        <script>
            /**
             *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
             *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
            /*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
            (function () {
                // DON'T EDIT BELOW THIS LINE
                var d = document,
                    s = d.createElement('script');
                s.src = 'https://yorijori.disqus.com/embed.js';
                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
            })();
        </script>
        <noscript
            >Please enable JavaScript to view the
            <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript
        >

        <!-- Optional JavaScript -->
        <!-- jQuery first, then Popper.js, then Bootstrap JS -->
        <script
            src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
            integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
            crossorigin="anonymous"
        ></script>
        <script
            src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
            integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
            crossorigin="anonymous"
        ></script>
        <script
            src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
            integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
            crossorigin="anonymous"
        ></script>
        <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>
        <script>
            function readURL(input) {
                if (input.files && input.files[0]) {
                    var reader = new FileReader();

                    reader.onload = function (e) {
                        $('.image-upload-wrap').hide();
                        $('#loading').show();
                        $('.file-upload-image').attr('src', e.target.result);
                        $('.file-upload-content').show();
                        $('.image-title').html(input.files[0].name);
						                        
                    };
                    reader.readAsDataURL(input.files[0]);
                    init().then(() => {
                        console.log('hello');
                        predict();
                        $('#loading').hide();
                    });
                } else {
                    removeUpload();
                }
            }

            function removeUpload() {
                $('.file-upload-input').replaceWith($('.file-upload-input').clone());
                $('.file-upload-content').hide();
                $('.image-upload-wrap').show();
            }
            $('.image-upload-wrap').bind('dragover', function () {
                $('.image-upload-wrap').addClass('image-dropping');
            });
            $('.image-upload-wrap').bind('dragleave', function () {
                $('.image-upload-wrap').removeClass('image-dropping');
            });
        </script>
        <script type="text/javascript">
            // More API functions here:
            // https://github.com/googlecreativelab/teachablemachine-community/tree/master/libraries/image

            // the link to your model provided by Teachable Machine export panel
            const URL = 'https://teachablemachine.withgoogle.com/models/CpkqJs7Rh/';

            let model, webcam, labelContainer, maxPredictions;

            // Load the image model and setup the webcam
            async function init() {
                const modelURL = URL + 'model.json';
                const metadataURL = URL + 'metadata.json';

                // load the model and metadata
                // Refer to tmImage.loadFromFiles() in the API to support files from a file picker
                // or files from your local hard drive
                // Note: the pose library adds "tmImage" object to your window (window.tmImage)
                model = await tmImage.load(modelURL, metadataURL);
                maxPredictions = model.getTotalClasses();

                // Convenience function to setup a webcam
                /* const flip = true; // whether to flip the webcam
                webcam = new tmImage.Webcam(500, 500, flip); // width, height, flip
                await webcam.setup(); // request access to the webcam
                await webcam.play();
                window.requestAnimationFrame(loop);*/

                // append elements to the DOM
                /*document.getElementById('webcam-container').appendChild(webcam.canvas);*/
                labelContainer = document.getElementById('label-container');
                for (let i = 0; i < maxPredictions; i++) {
                    // and class labels
                    labelContainer.appendChild(document.createElement('div'));
                }
            }

            /*async function loop() {
                webcam.update(); // update the webcam frame
                await predict();
                window.requestAnimationFrame(loop);
            }*/

            // run the webcam image through the image model
            async function predict() {
                var image = document.getElementById('mt-image');
                const prediction = await model.predict(image, false);
                prediction.sort((a, b) => parseFloat(b.probability) - parseFloat(a.probability));
                console.log(prediction[0].className);
                var resultMessage;
                switch (prediction[0].className) {
                    case '달걀':
                        resultMessage =
                            '<p><a href="recipe2/egg1.html" target="_blank"> <button type="button" class="button1">고추장 달걀 조림</button></a><p/> 	                                                                                          <p><a href="recipe2/egg2.html" target="_blank"> <button type="button" class="button2">참치계란밥</button></a><p/>                                                                                                  <p><a href="recipe2/egg3.html" target="_blank"> <button type="button" class="button3">파프리카 계란찜</button></a><p/>';

                        break;

                    case '닭고기':
                        resultMessage =
                            '<p><a href="recipe2/chicken1.html" target="_blank"> <button type="button" class="button1">닭장국</button></a><p/>                                                                                                  <p><a href="recipe2/chicken2.html" target="_blank" ><button type="button" class="button2">양파 닭가슴살 계란전</button></a><p/>                                                                                      <p> <a href="recipe2/chicken3.html" target="_blank" ><button type="button" class="button3">치즈불닭</button></a><p/>';
                        break;

                    case '돼지고기':
                        resultMessage =
                            '<p><a href="recipe2/pig1.html" target="_blank"> <button type="button" class="button1">돼지고기 고추장 찌개</button></a>  <p/>                                                                                        <p><a href="recipe2/pig2.html" target="_blank" ><button type="button" class="button2">부타동</button></a> <p/>                                                                                                    <p><a href="recipe2/pig3.html" target="_blank" ><button type="button" class="button3">목살 스테이크</button></a> <p/>';

                        break;

                    case '라면':
                        resultMessage =
                            '<p><a href="recipe2/ramen1.html" target="_blank"> <button type="button" class="button1">굴소스마요라면</button></a> <p/>                                                                                            <p> <a href="recipe2/ramen2.html" target="_blank" ><button type="button" class="button2">시원한 냉라면</button></a>  <p/>                                                                                            <p> <a href="recipe2/ramen3.html" target="_blank" ><button type="button" class="button3">신라면투움바파스타</button></a><p/>';
                        break;

                    case '만두':
                        resultMessage =
                            '<p><a href="recipe2/dumpling1.html" target="_blank"> <button type="button" class="button1">떠먹는피자</button></a><p/>                                                                                                <p><a href="recipe2/dumpling2.html" target="_blank" ><button type="button" class="button2">만두동</button></a>  <p/>                                                                                                      <p><a href="recipe2/dumpling3.html" target="_blank" ><button type="button" class="button3">비엔나만두강정</button></a> <p/>';
                        break;

                    case '배추김치':
                        resultMessage =
                            '<p><a href="recipe2/kimchi1.html" target="_blank"> <button type="button" class="button1">두부김치덮밥</button></a>    <p/>                                                                                            <p><a href="recipe2/kimchi2.html" target="_blank" ><button type="button" class="button2">베이컨김치말이밥</button></a>   <p/>                                                                                            <p><a href="recipe2/kimchi3.html" target="_blank" ><button type="button" class="button3">참치김치볶음</button></a> <p/>';
                        break;

                    case '소시지':
                        resultMessage =
                            '<p><a href="recipe2/macom.html" target="_blank"> <button type="button" class="button1">매콤 소시지 달걀 치즈구이</button></a> <p/>                                                                                              <p><a href="recipe2/s_kong.html" target="_blank" ><button type="button" class="button2">소시지 콩나물찜</button></a><p/>                                                                                                    <p><a href="recipe2/s_kangjung.html" target="_blank" ><button type="button" class="button3">소시지강정</button></a> <p/>';
                        break;

                    case '스팸':
                        resultMessage =
                            '<p><a href="recipe2/sp_dongbab.html" target="_blank"> <button type="button" class="button1">스팸동</button></a><p/>                                                                                                  <p> <a href="recipe2/sp_kimchibab.html" target="_blank" ><button type="button" class="button2">스팸김치볶음밥</button></a><p/>                                                                                                      <p> <a href="recipe2/sp_mayobab.html" target="_blank" ><button type="button" class="button3">스팸마요덮밥</button></a><p/>';
                        break;

                    case '식빵':
                        resultMessage =
                            '<p><a href="recipe2/bread1.html" target="_blank"> <button type="button" class="button1">식빵애플파이</button></a><p/>                                                                                                                                                     <p> <a href="recipe2/bread2.html" target="_blank" ><button type="button" class="button2">식빵카레고로케</button></a><p/>                                                                                                                                                      <p> <a href="recipe2/bread3.html" target="_blank" ><button type="button" class="button3">식빵팝콘</button></a><p/>';
                        break;

                    case '참치':
                        resultMessage =
                            '<p><a href="recipe2/tuna1.html" target="_blank"> <button type="button" class="button1">참치스테이크</button></a><p/>                                                                                                                                                      <p> <a href="recipe2/tuna2.html" target="_blank" ><button type="button" class="button2">참치 알리오 올리오 볶음밥</button></a><p/>                                                                                                                                                     <p> <a href="recipe2/tuna3.html" target="_blank" ><button type="button" class="button3">참치마요 볼</button></a><p/>';
                        break;

                    default:
                        resultMessage = '알수없음';
                }
                $('.result-Message').html(resultMessage);

                /*if (
                            prediction[0].className == '달걀' && prediction[0]
          				) {
            				labelContainer.childNodes[0].innerHTML = '달';
                        } else if (
                            prediction[1].className == '닭고기' && prediction[1]
                        ) {
                            labelContainer.childNodes[0].innerHTML = '닭';
                        } else if (
                            prediction[2].className == '돼지고기' && prediction[2]
                        ) {
                            labelContainer.childNodes[2].innerHTML = '돼';
                        } else if (
                            prediction[3].className == '라면' && prediction[3].probability.toFixed(2) == 1.0
                        ) {
                            labelContainer.childNodes[3].innerHTML = '라';
                        } else if (
                            prediction[4].className == '만두' && prediction[4].probability.toFixed(2) == 1.0
                        ) {
                            labelContainer.childNodes[4].innerHTML = '만';
                        } else if (
                            prediction[5].className == '배추김치' && prediction[5].probability.toFixed(2) == 1.0
                        ) {
                            labelContainer.childNodes[5].innerHTML = '배';
                        } else if (
                            prediction[6].className == '소시지' && prediction[6].probability.toFixed(2) == 1.0
                        ) {
                            labelContainer.childNodes[6].innerHTML = '소';
                        } else if (
                            prediction[7].className == '스팸' && prediction[7].probability.toFixed(2) == 1.0
                        ) {
                            labelContainer.childNodes[7].innerHTML = '스';
                        } else if (
                            prediction[8].className == '식빵' && prediction[8].probability.toFixed(2) == 1.0
                        ) {
                            labelContainer.childNodes[8].innerHTML = '식';
                        } else if (
                            prediction[9].className == '참치' && prediction[9].probability.toFixed(2) == 1.0
                        ) {
                            labelContainer.childNodes[9].innerHTML = '참';
                        }
          				  else{
            				labelContainer.childNodes[9].innerHTML = '알수없음';
           				}*/

                /*for (let i = 0; i < maxPredictions; i++) {
                            const classPrediction =
                                prediction[i].className + ': ' + prediction[i].probability.toFixed(2);
                            labelContainer.childNodes[i].innerHTML = classPrediction;
                        }*/
            }
        </script>
    </body>
</html>